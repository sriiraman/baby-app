trigger:
- main   # or master branch

pool:
  vmImage: 'ubuntu-latest'

variables:
  imageName: 'sriiraman/baby-app'  # replace with your Docker Hub username/repo

steps:
# 1️⃣ Checkout the code
- task: Checkout@1

# 2️⃣ Login to Docker Hub
- task: Docker@2
  displayName: 'Login to Docker Hub'
  inputs:
    command: login
    containerRegistry: 'DockerHubConnection1'  # Make sure you create this service connection in Azure DevOps

# 3️⃣ Build and push the Docker image
- task: Docker@2
  displayName: 'Build and Push Docker Image'
  inputs:
    command: buildAndPush
    repository: '$(imageName)'
    Dockerfile: '**/Dockerfile'
    tags: 'latest'
    containerRegistry: 'DockerHubConnection1'